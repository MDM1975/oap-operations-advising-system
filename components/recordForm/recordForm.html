<template>
    <c-modal size={size} onclose={handleCancel}>
        <template lwc:if={hasRecordType}>
            <c-async-wrapper promise={recordTypeId} onresolved={handleResolved} onrejected={handleRejected}>
                <div class="slds-form">
                    <div class="slds-text-align_center">
                        <span class="slds-text-heading_medium slds-p-bottom_small">{title}</span>
                    </div>
                    <div class="slds-grid slds-gutters slds-wrap slds-p-around_medium">
                        <template for:each={fields} for:item="field">
                            <div key={field.name} class={style}>
                                <c-record-form-field field={field} onchange={handleFieldChange}></c-record-form-field>
                            </div>
                        </template>
                        <div class="slds-col">
                            <slot name="extra-fields"></slot>
                        </div>
                    </div>
                    <div class="slds-grid slds-grid_align-center slds-gutters slds-p-top_small">
                        <div class="slds-col">
                            <lightning-button variant="destructive-text" label="Cancel"
                                onclick={handleCancel}></lightning-button>
                        </div>
                        <div class="slds-col">
                            <lightning-button variant="brand-outline" label="Save"
                                onclick={handleSubmit}></lightning-button>
                        </div>
                    </div>
                </div>
            </c-async-wrapper>
        </template>
        <template lwc:else>
            <div class="slds-form">
                <div class="slds-text-align_center">
                    <span class="slds-text-heading_medium slds-p-bottom_small">{title}</span>
                </div>
                <div class="slds-grid slds-gutters slds-wrap slds-p-around_medium">
                    <template for:each={fields} for:item="field">
                        <div key={field.name} class={style}>
                            <c-record-form-field field={field} onchange={handleFieldChange}></c-record-form-field>
                        </div>
                    </template>
                    <div class="slds-col">
                        <slot name="extra-fields"></slot>
                    </div>
                </div>
                <div class="slds-grid slds-grid_align-center slds-gutters slds-p-top_small">
                    <div class="slds-col">
                        <lightning-button variant="destructive-text" label="Cancel"
                            onclick={handleCancel}></lightning-button>
                    </div>
                    <div class="slds-col">
                        <lightning-button variant="brand-outline" label="Save"
                            onclick={handleSubmit}></lightning-button>
                    </div>
                </div>
            </div>
        </template>
    </c-modal>
</template>